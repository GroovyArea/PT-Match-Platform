<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="itwill.helljava.mapper.TrainerMapper">
	<insert id="insertTrainer">
		<selectKey resultType="int" keyProperty="trainer_no" order="BEFORE">
			select seq_trainer.nextval from dual
		</selectKey>
		insert into trainer values(
		#{trainer_no},
		#{member_no},
		#{trainer_profile_img},
		#{trainer_address1},
		#{trainer_addresss2},
		#{trainer_zip})
	</insert>
	
	<update id="updateTrainer">
		update trainer
		<set>
			<if test="trainer_profile_img!=null and trainer_profile_img!=''">
				trainer_profile_img=#{trainer_profile_img}
			</if>
			<if test="trainer_address1!=null and trainer_address1!=''">
				trainer_profile_img=#{trainer_profile_img}
			</if>
			<if test="trainer_addresss2!=null and trainer_addresss2!=''">
				trainer_addresss2=#{trainer_addresss2}
			</if>
			<if test="trainer_zip!=null and trainer_zip!=''">
				trainer_zip=#{trainer_zip}
			</if>
		</set>
			where trainer_no = #{trainer_no}
	</update>
	
	<select id="selectTrainer" resultType="Trainer">
		select * from trainer t right join member m
			on t.member_no = m.member_no 
		 where trainer_no= #{trainer_no}
	</select>
	
	<select id="selectTrainerList" parameterType="map" resultType="Trainer">

			select * from     
			(select rownum rn,board.* from 
			(select * from member m right join trainer t 
			            on m.member_no = t.member_no 
		<trim prefix="where" prefixOverrides="and">
			<if test="member_id != null and member_id != ''" >
				m.member_id like '%'||#{member_id}||'%'
			</if>
			<if test="member_name != null and member_name != ''">
				m.member_name like '%'||#{member_name}||'%'
			</if>
			and m.member_status = #{member_status}
		</trim>
		order by m.member_no desc) board)
			where rn between #{startRow} and #{endRow}
			
	</select>
	
	<select id="selectMainPageTrainerList" parameterType="map" resultType="Trainer">
		select * from 
		(select rownum rn, board.* from
		(select * from member m right join trainer t
					on m.member_no = t.member_no
		<trim prefix="where" prefixOverrides="and">
			<if test="member_name != null and member_name != '' and
					trainer_address == null and  
					trainer_centername == null ">
				member_name like '%'||#{member_name}||'%'
			</if>
			<if test="member_name == null and
					trainer_address != null and trainer != '' and 
					trainer_centername == null">
				trainer_address like '%'||#{trainer_address}||'%'
			</if>
			<if test="member_name == null and
					trainer_address == null and  
					trainer_centername != null and trainer_centername != ''">
				trainer_centername like '%'||#{trainer_centername}||'%'
			</if>
				and m.member_status = 3
		</trim>
			order by m.member_no desc) board)
			where rn between #{startRow} and #{endRow}
	</select>

</mapper>
	